<div class="perspective">
  <nz-card class="results-table-card card-3d-elevated animate-fade-in-3d" *ngIf="dataSet && dataSet.length > 0">
    <h3 class="card-title float-3d">
      <span nz-icon nzType="table" class="card-icon"></span>
      Detailed Results
    </h3>
    <nz-table [nzData]="dataSet" [nzSize]="'middle'" class="modern-table table-3d" [nzFrontPagination]="false" [nzShowPagination]="false">
      <thead>
        <tr class="table-header-3d">
          <th nzWidth="40%"><span nz-icon nzType="book"></span>Test Name</th>
          <th nzWidth="20%"><span nz-icon nzType="question-circle"></span>Questions</th>
          <th nzWidth="20%"><span nz-icon nzType="check-circle"></span>Score</th>
          <th nzWidth="20%"><span nz-icon nzType="percentage"></span>Percentage</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let result of dataSet; let i = index" class="table-row table-row-3d animate-slide-up-3d" [style.animation-delay]="(i * 0.05) + 's'">
          <td class="test-name-cell">
            <div class="test-info">
              <span class="test-title">{{ result.testName || result.test?.name || 'Unnamed Test' }}</span>
              <span class="test-subtitle" *ngIf="result.test?.description">{{ result.test.description }}</span>
            </div>
          </td>
          <td class="text-center">
            <nz-tag nzColor="blue" class="tag-3d">{{ result.totalQuestions || result.test?.questions?.length || 0 }}</nz-tag>
          </td>
          <td class="text-center">
            <span class="score-display badge-3d">{{ getCorrectAnswersCount(result) }} / {{ result.totalQuestions || result.test?.questions?.length || 0 }}</span>
          </td>
          <td class="text-center">
            <div class="percentage-cell">
              <nz-progress [nzPercent]="getScorePercentage(result)" [nzStrokeColor]="getScoreColor(getScorePercentage(result))" nzSize="small" [nzShowInfo]="false" class="progress-3d"></nz-progress>
              <span class="percentage-text" [style.color]="getScoreColor(getScorePercentage(result))">{{ getScorePercentage(result) }}%</span>
            </div>
          </td>
        </tr>
      </tbody>
    </nz-table>
    
    <!-- Pagination Controls -->
    <div class="pagination-container card-3d-subtle p-4 animate-slide-up-3d" *ngIf="totalResults > pageSize" style="animation-delay: 0.3s">
      <nz-pagination 
        [(nzPageIndex)]="pageIndex"
        [nzTotal]="totalResults" 
        [nzPageSize]="pageSize"
        [nzShowSizeChanger]="false"
        (nzPageIndexChange)="onPageChange($event)"
        nzShowQuickJumper
        class="pagination-3d">
      </nz-pagination>
    </div>
  </nz-card>
</div>